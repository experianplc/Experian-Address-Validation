var options={searchType:"autocomplete",maxSuggestions:10,useSpinner:!1,elements:{countryList:document.querySelector("select"),address_line_1:document.querySelector("input[name='address_line_1']"),address_line_2:document.querySelector("input[name='address_line_2']"),address_line_3:document.querySelector("input[name='address_line_2']"),locality:document.querySelector("input[name='locality']"),region:document.querySelector("input[name='region']"),postal_code:document.querySelector("input[name='postal_code']"),country:document.querySelector("input[name='country']"),lookupButton:document.querySelector("button#find-address-button")}};localStorage&&localStorage.getItem("address-validation-token")&&(options.token=localStorage.getItem("address-validation-token"));var addressValidationMap,addressValidationW3wMarker,addressValidationGeoMarker,address=new AddressValidation(options);function addToken(){address.setToken(document.querySelector('[name="token"]').value),document.querySelector("main").classList.remove("inactive"),document.querySelector(".token-prompt").classList.add("hidden"),localStorage&&localStorage.setItem("address-validation-token",document.querySelector('[name="token"]').value)}function togglePanel(e){document.querySelectorAll(".search-type-selector").forEach((e=>e.classList.remove("search-type-selected"))),e.currentTarget.classList.add("search-type-selected"),address.setSearchType(e.currentTarget.dataset.panelType)}address.events.on("post-datasets-update",(function(){let e=options.elements.countryList,t=e.getElementsByTagName("option");Array.from(t).filter((e=>"Please select"!==e.innerText)).forEach((e=>e.remove()));let s=address.countryDropdown;for(const t of s){const s=document.createElement("option");s.setAttribute("value",t.iso3Code),s.innerText=t.country,e.append(s)}})),address.events.on("pre-formatting-search",(function(){document.querySelector(".loader").classList.remove("hidden")})),address.events.on("post-formatting-search",(function(e){document.querySelector(".loader").classList.add("hidden"),document.querySelector("#validated-address-info").classList.remove("hidden"),"No matches"===e.result.confidence&&"autocomplete"!==address.searchType||(document.querySelector(".formatted-address").classList.remove("hidden"),document.querySelectorAll(".formatted-address .hidden").forEach((e=>e.classList.remove("hidden"))),document.querySelector(".promptset").classList.add("hidden")),populateMetadata(e)})),address.events.on("post-formatting-lookup",(function(e,t){document.querySelector(".loader").classList.add("hidden"),document.querySelector("#validated-address-info").classList.add("hidden"),document.querySelectorAll(".formatted-address").forEach((e=>e.classList.remove("hidden"))),document.querySelector(".promptset").classList.add("hidden"),address.getLookupEnrichmentData(e),document.querySelector(".metadata").classList.remove("invisible")})),address.events.on("post-reset",(function(){document.querySelector(".formatted-address").classList.add("hidden"),resetMetadata(),document.querySelector(".promptset").classList.remove("hidden"),"lookupv2"===address.searchType&&(document.getElementById("address-input-0").getElementsByTagName("option")[0].selected="true",document.getElementById("address-input-1").getElementsByTagName("option")[0].selected="true")})),address.events.on("request-error-400",(function(){document.querySelector(".loader").classList.add("hidden")})),address.events.on("request-error-401",(function(){document.querySelector("main").classList.add("inactive"),document.querySelector(".token-prompt").classList.remove("hidden")})),address.events.on("post-promptset-check",(function(e){const t=[];let s=document.querySelector(".error-display");s.classList.contains("hidden")||(s.classList.add("hidden"),document.querySelector(".promptset").classList.remove("hidden")),document.querySelector(".address-field-inputs").innerHTML="",e.result.lines.forEach(((e,s)=>{const d=document.createElement("label");let o;d.setAttribute("for",`address-input-${s}`),d.innerText=e.prompt,e.dropdown_options?(o=document.createElement("select"),o.classList.add("address-input"),o.setAttribute("id",`address-input-${s}`),e.dropdown_options.forEach((e=>{const t=document.createElement("option");t.setAttribute("value",e.key),t.innerText=e.display,o.append(t)}))):(o=document.createElement("input"),o.classList.add("address-input"),o.setAttribute("type","text"),o.setAttribute("id",`address-input-${s}`),e.suggested_input_length&&o.setAttribute("size",e.suggested_input_length),e.example&&o.setAttribute("placeholder",e.example)),t.push(o),document.querySelector(".address-field-inputs").append(d,o)})),address.setInputs(t),document.querySelector("button#find-address-button").classList["autocomplete"!==address.searchType?"remove":"add"]("hidden")})),address.events.on("error-display",(function(e){document.querySelector(".promptset").classList.add("hidden"),resetMetadata(),document.querySelectorAll(".formatted-address").forEach((e=>e.classList.add("hidden")));let t=document.querySelector(".error-display");t.classList.remove("hidden"),t.getElementsByTagName("label")[0].innerText=e})),document.querySelectorAll(".search-type-selector").forEach((e=>e.addEventListener("click",togglePanel)));