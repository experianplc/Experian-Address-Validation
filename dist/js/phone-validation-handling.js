document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("phone"),t=document.getElementById("phone-validation-trigger"),n=document.getElementById("phone-validation-result"),o=document.getElementById("country-code");let a,i=document.getElementById("phone-validation-error");i||(i=document.createElement("div"),i.id="phone-validation-error",i.className="validation-inline-error hidden",e.insertAdjacentElement("afterend",i)),window.addEventListener("validation-token-set",(e=>{var t;t=e.detail.token,a=new PhoneValidation({token:t})}),{once:!0});let d=!1;window.addEventListener("validation-token-set",(()=>{d=!0,t&&(t.style.opacity="1",t.style.pointerEvents="auto")}),{once:!0}),t&&(t.style.opacity="0.6",t.style.pointerEvents="none"),e&&e.addEventListener("keypress",(function(e){"Enter"===e.key&&(e.preventDefault(),t&&t.click())})),t&&t.addEventListener("click",(function(){if(!d)return void alert("Please enter a token first.");const n=e.value,l=o.value;if(!l)return i.textContent="Please select a country before validating the phone number.",i.classList.remove("hidden"),void i.classList.add("fade-in");if(i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in"),window.RateLimiter&&"function"==typeof window.RateLimiter.allowCall)return t.style.opacity="0.6",t.style.pointerEvents="none",void window.RateLimiter.allowCall().then((function(e){if(t.style.opacity="1",t.style.pointerEvents="auto",!e.allowed)return i.textContent="You have reached the maximum of 10 validations in 24 hours.",i.classList.remove("hidden"),void i.classList.add("fade-in");const o={number:n,output_format:"NATIONAL",cache_value_days:0,country_iso:l,get_ported_date:!0,get_disposable_number:!0,supplementary_live_status:{mobile:"USA"===l?[l]:[],landline:"GBR"===l?[l]:[]}};a.validatePhone(o)})).catch((function(){t.style.opacity="1",t.style.pointerEvents="auto";const e={number:n,output_format:"NATIONAL",cache_value_days:0,country_iso:l,get_ported_date:!0,get_disposable_number:!0,supplementary_live_status:{mobile:"USA"===l?[l]:[],landline:"GBR"===l?[l]:[]}};a.validatePhone(e)}));const s={number:n,output_format:"NATIONAL",cache_value_days:0,country_iso:l,get_ported_date:!0,get_disposable_number:!0,supplementary_live_status:{mobile:"USA"===l?[l]:[],landline:"GBR"===l?[l]:[]}};a.validatePhone(s)})),window.addEventListener("validation-token-set",(()=>{a&&a.events.on("post-validation",(function(e){const t=document.getElementById("phone-validation-result-body");n.classList.remove("hidden"),t.innerHTML="";const o=n.querySelector(".content");o&&(o.style.display="block");const a={"result.number":"Phone Number","result.validated_phone_number":"Validated Phone Number","result.formatted_phone_number":"Formatted Phone Number","result.phone_type":"Type","result.confidence":"Confidence","result.ported_date":"Ported Date","result.disposable_number":"Disposable number"};for(const n in a){const o=a[n],d=(i=e,n.split(".").reduce(((e,t)=>e&&e[t]),i));if(void 0!==d){const e=document.createElement("tr"),n=document.createElement("td");n.innerText=o,n.className="result-label-cell";const a=document.createElement("td");a.innerText=d,e.appendChild(n),e.appendChild(a),t.appendChild(e)}}var i;if(e.metadata&&e.metadata.phone_detail){const n=e.metadata.phone_detail;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const o=document.createElement("tr"),a=document.createElement("td");a.innerText=e.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())),a.className="result-label-cell";const i=document.createElement("td");i.innerText=n[e],o.appendChild(a),o.appendChild(i),t.appendChild(o)}}}))}),{once:!0}),window.addEventListener("validation-token-set",(()=>{a&&a.events.on("validation-error",(function(e){n.classList.remove("hidden"),n.innerText=`Error: ${e}`,i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in")}))}),{once:!0}),o.addEventListener("change",(()=>{o.value&&(i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in"))}));const l=n.querySelector("h2");l&&l.addEventListener("click",(function(){const e=n.querySelector(".content");e&&("none"===e.style.display?(e.style.display="block",l.classList.remove("collapsed")):(e.style.display="none",l.classList.add("collapsed")))}))}));