document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("email"),t=document.getElementById("email-validation-trigger"),n=document.getElementById("email-validation-result");let i=document.getElementById("email-validation-error");i||(i=document.createElement("div"),i.id="email-validation-error",i.className="validation-inline-error hidden",e.insertAdjacentElement("afterend",i));let a,d=document.getElementById("email-suggestion-dropdown");d||(d=document.createElement("div"),d.id="email-suggestion-dropdown",d.className="email-suggestions hidden",e.insertAdjacentElement("afterend",d)),window.addEventListener("validation-token-set",(e=>{var t;t=e.detail.token,a=new EmailValidation({token:t})}),{once:!0});let s=!1;window.addEventListener("validation-token-set",(()=>{s=!0,t&&(t.style.opacity="1",t.style.pointerEvents="auto")}),{once:!0}),t&&(t.style.opacity="0.6",t.style.pointerEvents="none"),e&&e.addEventListener("keypress",(function(e){"Enter"===e.key&&(e.preventDefault(),t&&t.click())})),t&&t.addEventListener("click",(function(){if(!s)return void alert("Please enter a token first.");const n=e.value;if(a){if(!n.trim())return i.textContent="Please enter an email address before validating.",i.classList.remove("hidden"),void i.classList.add("fade-in");if(i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in"),window.RateLimiter&&"function"==typeof window.RateLimiter.allowCall)return t.style.opacity="0.6",t.style.pointerEvents="none",void window.RateLimiter.allowCall().then((function(e){if(t.style.opacity="1",t.style.pointerEvents="auto",!e.allowed)return i.textContent="You have reached the maximum of 10 validations in 24 hours.",i.classList.remove("hidden"),void i.classList.add("fade-in");a.validateEmail(n)})).catch((function(){t.style.opacity="1",t.style.pointerEvents="auto",a.validateEmail(n)}));a.validateEmail(n)}else alert("Please enter a token first.")})),window.addEventListener("validation-token-set",(()=>{a&&a.events.on("post-validation",(function(t){const a=document.getElementById("validation-result-body");n.classList.remove("hidden"),a.innerHTML="",i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in"),t.result&&t.result.did_you_mean&&t.result.did_you_mean.length>0?(d.innerHTML="",d.classList.remove("hidden"),t.result.did_you_mean.forEach((function(t){const n=document.createElement("div");n.className="suggestion-item",n.textContent="Did you mean: "+t,n.style.cursor="pointer",n.addEventListener("click",(function(){e.value=t,d.classList.add("hidden"),d.innerHTML=""})),d.appendChild(n)}))):(d.classList.add("hidden"),d.innerHTML="");const s=n.querySelector(".content");s&&(s.style.display="block");const o={"result.email":"Email","result.confidence":"Status","result.verbose_output":"Verbose Output","metadata.domain_detail.type":"Type"};for(const e in o){const n=o[e],i=(l=t,e.split(".").reduce(((e,t)=>e&&e[t]),l));if(void 0!==i){const e=document.createElement("tr"),t=document.createElement("td");t.innerText=n,t.className="result-label-cell";const d=document.createElement("td");d.innerText=i,e.appendChild(t),e.appendChild(d),a.appendChild(e)}}var l}))}),{once:!0}),window.addEventListener("validation-token-set",(()=>{a&&a.events.on("validation-error",(function(e){n.classList.remove("hidden"),n.innerText=`Error: ${e}`,i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in")}))}),{once:!0}),e.addEventListener("input",(()=>{e.value.trim()&&(i.textContent="",i.classList.add("hidden"),i.classList.remove("fade-in")),d.classList.add("hidden"),d.innerHTML=""}));const o=n.querySelector("h2");o&&o.addEventListener("click",(function(){const e=n.querySelector(".content");e&&("none"===e.style.display?(e.style.display="block",o.classList.remove("collapsed")):(e.style.display="none",o.classList.add("collapsed")))}))}));